# Flutter Project Packaging with lpkg

This document outlines the expected structure and content of `meta.toml` and `.desktop` files for Flutter projects when they are packaged using `lpkg`. The `lpkg init` command automatically generates these files based on your Flutter project's configuration.

## `meta.toml` Structure

The `meta.toml` file provides essential metadata about your package. For Flutter projects, `lpkg init` extracts information primarily from `pubspec.yaml` and `linux/CMakeLists.txt`.

```toml
[package]
name = "your_package_name" # Extracted from pubspec.yaml (e.g., "libreconvert")
version = "x.y.z+b" # Extracted from pubspec.yaml (e.g., "1.0.0+2")
description = "Your application's description." # Extracted from pubspec.yaml
license = "MIT" # Defaulted to MIT, or extracted if specified in pubspec.yaml
content_checksum = "generated_checksum_by_lpkg_pack" # Automatically generated by 'lpkg pack'
application_id = "your.application.id" # Extracted from linux/CMakeLists.txt (e.g., "dev.libretools.convert.libreconvert")

# Other optional fields can be added manually if needed:
# homepage = "https://your-app-homepage.com"
# repository = "https://github.com/your-org/your-app"
# authors = ["Author Name <email@example.com>"]
```

## `.desktop` File Structure

The `.desktop` file provides metadata for desktop environments, allowing your application to appear in menus, have an icon, and handle single-instance behavior. This file is generated by `lpkg init` and placed in `files/usr/share/applications/` within the package.

```desktop
[Desktop Entry]
Version=1.0
Type=Application
Name=your_package_name # Extracted from pubspec.yaml (e.g., "libreconvert")
Comment=Your application's description. # Extracted from pubspec.yaml
Exec=your_package_name # Points to the symlink in /usr/local/bin (e.g., "libreconvert")
Icon=your_package_name # Points to the icon file (e.g., "libreconvert")
Terminal=false
Categories=Utility; # Default category, can be customized
StartupWMClass=your.application.id # Extracted from linux/CMakeLists.txt (e.g., "dev.libretools.convert.libreconvert")
```

**Key Points:**

*   The `Exec` field points to the symlink created by `lpkg install` in `/usr/local/bin/`. This symlink, in turn, points to a wrapper script that correctly sets up the Flutter application's environment.
*   The `StartupWMClass` is crucial for proper window grouping and single-instance behavior in desktop environments like GNOME. It must match the `APPLICATION_ID` defined in your Flutter project's `linux/CMakeLists.txt`.
